<!-- Support/templates/support/chat.html -->

{% extends 'support/base.html' %}
{% block content %}
<div class="container">
    <h1>Chat Support</h1>
    <div id="chat-messages">
        {% for message in messages %}
        <div class="message">
            <p><strong>{{ message.user.username }}</strong>: {{ message.message }}</p>
            <small>{{ message.timestamp|date:"M d, Y H:i" }}</small>
        </div>
        {% empty %}
        <p>No messages yet.</p>
        {% endfor %}
    </div>
    <form id="chat-form" method="post" action="{% url 'support:send_message' %}">
        {% csrf_token %}
        <input type="text" id="message-input" name="message" placeholder="Type your message here..." required>
        <button type="submit">Send</button>
    </form>
</div>
<script>
    let chatForm = document.getElementById('chat-form');
    chatForm.addEventListener('submit', function(event) {
        event.preventDefault();
        let messageInput = document.getElementById('message-input');
        let messageText = messageInput.value.trim();
        if (messageText !== '') {
            let messageHtml = `<div class="message"><p><strong>You</strong>: ${messageText}</p><small>Just now</small></div>`;
            document.getElementById('chat-messages').insertAdjacentHTML('beforeend', messageHtml);
            chatForm.reset();
            document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
        }
    });
</script>
{% endblock %}
